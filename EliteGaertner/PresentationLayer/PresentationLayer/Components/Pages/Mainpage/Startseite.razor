@page "/startseite"
@using Microsoft.AspNetCore.Components.Web
@inject NavigationManager Nav
@rendermode InteractiveServer

<div class="page-container">
    <header class="top-bar">
        
        <div class="icon-wrapper left" @onclick="GoToRanks">
            <img src="pictures/Rangliste.png" alt="Rangliste" height="40" /> 
            <span class="icon-label">Rangliste</span>
        </div>

        
        <div class="menu-icon-container">
            <span class="menu-icon" @onclick="ToggleLogoutMenu">‚ò∞</span>
        </div>
    </header>

    @if (showLogout)
    {
        <div class="logout-menu">
            <p @onclick="NavigateToLogout">Logout &lt;</p>
        </div>
    }

    <div class="tinder-card-area">
        @if (isProfileVisible)
        {
            <div class="tinder-card">
                <div class="card-image-placeholder">
                    <img src="pictures/Testbilder/Gurken_01.jpg" alt="Erntebild" class="harvest-image" />
                </div>

                <div class="info-box">
                    <div class="details">
                        <p><strong>Gurken</strong></p>
                        <p>Breite - cm</p>
                        <p>L√§nge - cm</p>
                        <p>Gewicht - kg</p>
                    </div>
                    <div class="comment">Hier k√∂nnte ein Kommentar zur Ernte stehen, der maximal 150 Zeichen umfasst und alle relevanten Infos kurz, pr√§zise und √ºbersichtlich vermittelt......
                        <p class="username">@user_name1</p>
                    </div>
                </div>
            </div>
            
            <div class="rating-icons">
                <div class="rating-icon flag-icon" @onclick="FlagProfile">
                    <span style="font-size: 20px;">üö©</span>
                </div>
                <div class="rating-icon dislike-icon" @onclick="DislikeProfile">
                    <span style="font-size: 24px;">‚ùå</span>
                </div>
                <div class="rating-icon like-icon" @onclick="LikeProfile">
                    <span style="font-size: 24px;">üíö</span>
                </div>
                <div class="rating-icon settings-icon" @onclick="NavigateToPreferences">
                    <img src="pictures/EinstellungenIcon.png" alt="Matches" height="27" />
                </div>
            </div>
        }
        else
        {
            <p style="font-size: 18px; font-weight: bold; text-align: center;">
                Profil wurde gemeldet und ausgeblendet.
            </p>
        }
        
        @if (showReportModal)
        {
            <div class="report-modal-overlay">
                <div class="report-modal">
                    
                    <p style="font-weight: bold; margin-bottom: 10px;">Post Melden</p>
                    
                    <div class="report-reason">
                        <input type="checkbox" id="abstossende" @onchange="@(e => UpdateReportReason("abstossende Inhalte", e))" checked="@(selectedReportReason == "abstossende Inhalte")" />
                        <label for="abstossende">abstossende Inhalte</label>
                    </div>
                    
                    <div class="report-reason">
                        <input type="checkbox" id="sexuelle" @onchange="@(e => UpdateReportReason("sexuelle Inhalte", e))" checked="@(selectedReportReason == "sexuelle Inhalte")" />
                        <label for="sexuelle">sexuelle Inhalte</label>
                    </div>
                    
                    <div class="report-reason">
                        <input type="checkbox" id="gewaltvolle" @onchange="@(e => UpdateReportReason("gewaltvolle Inhalte", e))" checked="@(selectedReportReason == "gewaltvolle Inhalte")" />
                        <label for="gewaltvolle">gewaltvolle Inhalte</label>
                    </div>
                    
                    <div class="report-reason">
                        <input type="checkbox" id="catfishing" @onchange="@(e => UpdateReportReason("Catfishing", e))" checked="@(selectedReportReason == "Catfishing")" />
                        <label for="catfishing">Catfishing</label>
                    </div>
                    
                    <div class="report-reason">
                        <input type="checkbox" id="spam" @onchange="@(e => UpdateReportReason("Spam", e))" checked="@(selectedReportReason == "Spam")" />
                        <label for="spam">Spam</label>
                    </div>

                    <div class="modal-actions">
                        <button class="report-button" @onclick="ReportProfile">Melden</button>
                        <div class="close-modal-icon" @onclick="CloseReportModal">
                            <span style="font-size: 10px;">‚ùå</span>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>

    <footer class="bottom-nav">
        <div class="nav-item active" @onclick="GoToMatches">
            <div class="nav-icon-wrapper">
                <img src="pictures/MatchesIcon.png" alt="Matches" height="40" />
                <div class="small-red-dot"></div> </div> 
            <span>Matches</span>
        </div>
        
        <div class="nav-item" @onclick="GoToMainpage">
            <img src="pictures/EliteG√§rtner_logo.png" alt="EliteG√§rtner" height="40" /> 
            <span class="elitegaertner-title mt-2" style="font-weight: 600; font-size: 1.0rem">EliteG√§rtner.</span>
        </div>
        
        <div class="nav-item" @onclick="GoToProfile">
            <img src="pictures/Profil_04.png" alt="Profile" height="40" /> 
            <span>Profil</span>
        </div>
    </footer>
</div>

@code {
    private bool showLogout = false;
    private bool showReportModal = false;
    private bool isProfileVisible = true;
    private string selectedReportReason = ""; 
    private string user_name1 = "@user_name1";

    
    private void ToggleLogoutMenu()
    {
        showLogout = !showLogout;
    }

    private void NavigateToLogout()
    {
        Nav.NavigateTo("/", forceLoad: true);
    }

    private void NavigateToPreferences()
    {
        Nav.NavigateTo("/praeferenzeinstellungen", forceLoad: true);
    }

    private void GoToRanks()
    {
        Nav.NavigateTo("/RanglisteTest", forceLoad: true);
    }
    private void GoToMatches()
    {
        Nav.NavigateTo("/MatchesTest", forceLoad: true);
    }

    private void GoToMainpage()
    {
        Nav.NavigateTo("/startseite", forceLoad: true);
    }

    private void GoToProfile()
    {
        Nav.NavigateTo("/ProfilTest", forceLoad: true);
    }

    private void FlagProfile()
    {
        showReportModal = true; 
    }

    private void CloseReportModal()
    {
        showReportModal = false;
    }

    private void UpdateReportReason(string reason, ChangeEventArgs e)
    {
        if ((bool)e.Value)
        {
            selectedReportReason = reason;
        }
        else if (selectedReportReason == reason)
        {
            selectedReportReason = string.Empty;
        }
    }

    private void ReportProfile()
    {
        if (!string.IsNullOrEmpty(selectedReportReason))
        {
            Console.WriteLine($"Profil gemeldet. Grund: {selectedReportReason}");
            isProfileVisible = false;
            showReportModal = false;
        }
        else
        {
            Console.WriteLine("Bitte w√§hlen Sie einen Meldegrund.");
        }
    }

    private void DislikeProfile() => Console.WriteLine("0");
    private void LikeProfile() => Console.WriteLine("1");
    
}
<style>
    /* Hauptfarben */
    :root {
        --main-purple: #8B45B3;
        --dislike-red: #D62828;
        --like-green: #4CAF50;
        --border-color: #000;
    }

    .page-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
        position: relative;
        overflow: hidden;
    }

    /* --- Header-Bar (Rangliste und Men√º) --- */
    .top-bar { 
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 15px;
        border-bottom: 1px solid #ccc;
        background-color: #fff;
        z-index: 10;
    }

    /* Icon Wrapper im Header soll vertikal sein (Rangliste Icon √ºber Text) */
    .icon-wrapper {
        display: flex;
        flex-direction: column; /* Vertikale Anordnung */
        align-items: center;
        font-weight: bold;
        font-size: 12px; /* Etwas kleiner f√ºr den Text */
        cursor: pointer;
    }

    .icon-wrapper img {
        margin-bottom: 2px; /* Abstand zwischen Icon und Text */
    }

    .menu-icon-container {
        cursor: pointer;
    }

    .menu-icon {
        font-size: 30px;
        font-weight: bold;
        line-height: 1;
        color: var(--border-color);
    }

    /* --- Logout-Men√º (Dropdown) --- */
    .logout-menu {
        position: absolute;
        top: 60px; /* Position unter dem Hamburger-Icon */
        right: 15px;
        width: 150px;
        background-color: #fff;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        z-index: 20;
        padding: 5px 0;
    }

    .logout-menu p {
        padding: 5px 10px;
        margin: 0;
        cursor: pointer;
        font-size: 16px;
        text-align: right;
    }

    .logout-menu p:hover {
        background-color: #eee;
    }

    /* --- Haupt-Karten-Bereich --- */
    .tinder-card-area {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        position: relative;
    }

    .tinder-card {
        width: 100%;
        max-width: 400px; /* Maximale Breite f√ºr das "Smartphone"-Layout */
        height: 80vh; /* Relative H√∂he zur Ansichtsh√∂he */
        max-height: 600px;
        border: 3px solid var(--border-color);
        border-radius: 10px;
        background-color: #fff;
        box-shadow: 5px 5px 0 0 var(--border-color); /* Sketch-Effekt */
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    .card-image-placeholder {
        width: 100%;
        flex-grow: 1;
        background-color: #eee;
        overflow: hidden;
    }

    .harvest-image {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Stellt sicher, dass das Bild den Container ausf√ºllt */
    }

    /* --- Info-Box (Gurken-Details) --- */
    .info-box {
        position: absolute;
        bottom: 20px; /* √úber den Rating-Icons */
        left: 20px;
        right: 20px;
        background-color: rgb(176, 66, 255); /* Transparente lila Farbe */
        color: white;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        box-shadow: 2px 2px 0 0 var(--border-color);
        display: flex;
        font-size: 14px;
    }

    .details {
        flex: 1;
        padding-right: 10px;
        border-right: 1px solid white;
    }

    .comment {
        flex: 2;
        padding-left: 10px;
    }

    .username {
        font-style: italic;
        font-weight: bold;
        margin-top: 5px;
    }

    /* --- Bewertungs-Icons (Mitte-Unten) --- */
    .rating-icons {
        position: absolute;
        bottom: -25px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 15px;
        background-color: #fff;
        padding: 10px;
        border-radius: 50px;
        z-index: 5;
    }

    .rating-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        border: 2px solid var(--border-color);
        position: relative;
        box-shadow: 2px 2px 0 0 var(--border-color);
        transition: transform 0.1s ease;
    }

    .rating-icon:active {
        transform: translate(-50%, 0) scale(0.95);
        box-shadow: 1px 1px 0 0 var(--border-color);
    }

    .dislike-icon {
        background-color: var(--dislike-red);
    }

    .like-icon {
        background-color: var(--like-green);
    }

    .flag-icon, .settings-icon {
        background-color: #fff;
    }

    /* Alter notification-dot (mit Zahl) wird versteckt, falls er noch im Code ist */
    .notification-dot {
        display: none;
    }

    /* NEU: Wrapper f√ºr das Icon in der Bottom Nav, um das Dot zu positionieren */
    .nav-icon-wrapper {
        position: relative; /* Wichtig, damit der Punkt relativ zum Icon sitzt */
        height: 40px; /* H√∂he des Icons */
        width: 40px; /* Breite des Icons */
        display: inline-block;
    }

    .nav-icon-wrapper img {
        display: block;
    }
    
    /* NEU: Roter Punkt ohne Zahl f√ºr Matches */
    .small-red-dot {
        position: absolute;
        top: -2px; /* Position oben rechts */
        right: -10px;
        background-color: var(--dislike-red);
        border-radius: 50%;
        width: 10px; /* Kleiner Punkt */
        height: 10px; /* Kleiner Punkt */
        border: 1px solid var(--border-color);
        z-index: 5;
    }

    /* --- Bottom Nav (Unten) --- */
    .bottom-nav {
        display: flex;
        justify-content: space-around;
        padding: 10px 0;
        border-top: 3px solid var(--border-color);
        background-color: #fff;
        z-index: 10;
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
        font-size: 12px;
        font-weight: bold;
        position: relative; /* Wichtig f√ºr die korrekte Ausrichtung */
    }
    
    /* --- Modal f√ºr unangemessene Inhalte melden --- */
    .report-modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: rgba(0, 0, 0, 0.1); /* Leicht transparentes Overlay */
        z-index: 50; /* √úber allen anderen Elementen */
    }

    .report-modal {
        width: 80%;
        max-width: 300px;
        background-color: #fff;
        padding: 20px;
        border: 3px solid var(--border-color);
        border-radius: 10px;
        box-shadow: 5px 5px 0 0 var(--border-color); /* Sketch-Effekt */
        position: relative;
    }

    .report-reason {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        font-size: 14px;
    }

    .report-reason input[type="checkbox"] {
        margin-right: 10px;
        width: 15px;
        height: 15px;
    }

    .modal-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 15px;
    }

    .report-button {
        background-color: var(--dislike-red);
        color: white;
        border: 2px solid var(--border-color);
        border-radius: 5px;
        padding: 8px 15px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 2px 2px 0 0 var(--border-color);
        transition: transform 0.1s ease;
    }

    .report-button:active {
        transform: translate(1px, 1px);
        box-shadow: 1px 1px 0 0 var(--border-color);
    }
    
    .close-modal-icon {
        background-color: #fff;
        border: 2px solid var(--border-color);
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 2px 2px 0 0 var(--border-color);
    }
</style>