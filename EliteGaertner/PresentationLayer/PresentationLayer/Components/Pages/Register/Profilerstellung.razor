@page "/registrierung/profilerstellung"
@inject NavigationManager NavigationManager
@rendermode InteractiveServer

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">


<div class="register-page-container">
    <div class="login-center">

        <div class="register-card profil-card">

            <div class="logo-container">
                @* HIER KEINE ÄNDERUNG, da die Aubergine NICHT im Unterordner Profilbilder liegt *@
                <img src="pictures/EliteGärtner_logo.png" alt="EliteGärtner Logo" class="app-logo-large" />
                <h2 class="elitegaertner-title-large">EliteGärtner.</h2>
            </div>

            <h3 class="register-title-comic">Erstelle dein Gärtnerprofil</h3>
            
            <div class="form-layout">
                
                <h4 class="tag-headline">Wähle dein Profilbild</h4>
                
                <div class="profile-carousel-hybrid">
                    
                    @* Pfeil Links *@
                    <button class="arrow-nav-button secondary-button" 
                            @onclick="SelectPreviousProfile">
                        <i class="bi bi-caret-left-fill"></i>
                    </button>

                    @* Vorschau Links (Vorgänger-Bild)*@
                    <div class="profile-preview-container-hybrid">
                        <img src="@($"pictures/Profilbilder/{GetProfileName(CurrentIndex - 1)}")" 
                             alt="Vorschau" 
                             class="profile-image-preview" />
                    </div>

                    @* Zentrales, ausgewähltes Bild*@
                    <div class="profile-main-image-container-hybrid selected-outline-hybrid">
                        <img src="@($"pictures/Profilbilder/{SelectedProfile}")" 
                             alt="Aktuelles Profilbild" 
                             class="profile-image-large" />
                    </div>
                    
                    @* Vorschau Rechts (Nachfolger-Bild)*@
                    <div class="profile-preview-container-hybrid">
                        <img src="@($"pictures/Profilbilder/{GetProfileName(CurrentIndex + 1)}")" 
                             alt="Vorschau" 
                             class="profile-image-preview" />
                    </div>
                    
                    @* Pfeil Rechts *@
                    <button class="arrow-nav-button secondary-button" 
                            @onclick="SelectNextProfile">
                        <i class="bi bi-caret-right-fill"></i>
                    </button>
                    
                </div>

                <div class="input-group">
                    <label class="input-label">Profilbeschreibung</label>
                    <textarea class="app-input-comic" @bind="Bio" placeholder="Erzähle kurz, wer du bist und was du anbaust..." maxlength="150"></textarea>
                    <div class="char-counter">@Bio.Length / 150</div>
                </div>

                <button class="app-button primary-button weiter-button"
                        @onclick="Weiter" 
                        disabled="@(!IsFormValid)">
                    Weiter zur Ernte
                </button>
                
                @if (!IsFormValid)
                {
                    <p class="disabled-hint">Bitte wähle zuerst ein Profilbild und füge eine Beschreibung hinzu.</p>
                }
            </div>
        </div>
    </div>
</div>

@code {
    private string Bio { get; set; } = "";
    
    // Alle verfügbaren Profilbilder
    private List<string> AvailableProfiles = new()
    {
        "Profilbild_01.png", "Profilbild_02.png", "Profilbild_03.png", "Profilbild_04.png", 
        "Profilbild_05.png", "Profilbild_06.png", "Profilbild_07.png", "Profilbild_08.png", 
        @* diese Profilbilder noch hinzufügen: *@
        "Profilbild_09.png", "Profilbild_10.png", "Profilbild_11.png", "Profilbild_12.png", 
        "Profilbild_13.png", "Profilbild_14.png", "Profilbild_15.png", "Profilbild_16.png", 
        "Profilbild_17.png", "Profilbild_18.png", "Profilbild_19.png", "Profilbild_20.png",
        "Profilbild_21.png", "Profilbild_22.png", "Profilbild_23.png", "Profilbild_24.png"
    };

    private string SelectedProfile { get; set; }
    private int CurrentIndex { get; set; }
    
    protected override void OnInitialized()
    {
        CurrentIndex = 0;
        SelectedProfile = AvailableProfiles[CurrentIndex];
    }

    private bool IsFormValid => !string.IsNullOrWhiteSpace(Bio) && !string.IsNullOrWhiteSpace(SelectedProfile);

    private string GetProfileName(int index)
    {
        int effectiveIndex = (index % AvailableProfiles.Count + AvailableProfiles.Count) % AvailableProfiles.Count;
        return AvailableProfiles[effectiveIndex];
    }
    
    private void SelectNextProfile()
    {
        CurrentIndex = (CurrentIndex + 1) % AvailableProfiles.Count;
        SelectedProfile = AvailableProfiles[CurrentIndex];
    }
    
    private void SelectPreviousProfile()
    {
        CurrentIndex = (CurrentIndex - 1 + AvailableProfiles.Count) % AvailableProfiles.Count;
        SelectedProfile = AvailableProfiles[CurrentIndex];
    }
    
    private void Weiter()
    {
        NavigationManager.NavigateTo("/ernte-hochladen", forceLoad: true);
    }
}


<style>

    .register-page-container {
        background-image: url('pictures/LightIconBackground.jpeg');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        height: 100%;
        min-height: 100vh;
        width: 100%;
        font-family: 'Patrick Hand', cursive, sans-serif;
        padding: 40px 0;
    }

    .login-center {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
    }

    .register-card {
        width: 90%;
        max-width: 600px;
        background: rgba(255, 255, 255, 0.95);
        border: 3px solid #000;
        border-radius: 15px;
        box-shadow: 6px 6px 0 0 #000;
        padding: 30px;
        margin: 20px;
    }

    .form-layout {
        display: block; 
    }
    
    .logo-container {
        text-align: center;
        margin-bottom: 20px;
    }

    .app-logo-large {
        width: 80px; 
    }

    .elitegaertner-title-large {
        font-family: 'Playfair Display', serif;
        font-weight: 600;
        font-size: 2.5rem; 
        color: #000;
        margin-top: 8px;
        line-height: 1;
    }

    .register-title-comic {
        font-weight: bold;
        font-size: 1.8rem;
        color: #000;
        margin-bottom: 30px; 
        text-align: center;
        border-bottom: 2px solid #000;
        padding-bottom: 10px;
    }

    .tag-headline {
        font-weight: bold;
        font-size: 1.4rem;
        color: #000;
        margin-top: 20px;
        margin-bottom: 10px;
        text-align: center;
    }

    .profile-carousel-hybrid {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px; 
        margin-bottom: 30px;
    }
    
    .profile-main-image-container-hybrid {
        width: 130px; 
        height: 130px;
        border: 4px solid #000;
        box-shadow: 6px 6px 0 0 #000;
        border-radius: 50%;
        overflow: hidden;
        background-color: #f0f0f0;
        flex-shrink: 0;
    }

    .selected-outline-hybrid {
        border: 5px solid #8B45B3; 
        box-shadow: 0 0 0 3px #000, 7px 7px 0 0 #000; 
    }
    
    .profile-preview-container-hybrid {
        width: 60px; 
        height: 60px;
        border: 2px solid #000;
        box-shadow: 3px 3px 0 0 #000;
        border-radius: 50%;
        overflow: hidden;
        background-color: #fff;
        opacity: 0.7; 
        flex-shrink: 0;
    }

    .profile-image-large {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    .profile-image-preview {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }
    
    .arrow-nav-button {
        width: 45px;
        height: 45px;
        padding: 0; 
        font-size: 1.5rem; 
        border-radius: 50%; 
        box-shadow: 3px 3px 0 0 #000; 
        margin-top: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-shrink: 0;
    }
    
    .arrow-nav-button:active {
        transform: translate(3px, 3px);
        box-shadow: 0 0 0 0 #000;
    }

    .input-group {
        margin-bottom: 15px;
        display: flex;
        flex-direction: column;
    }

    .input-label {
        font-weight: bold;
        margin-bottom: 5px;
        color: #000;
        font-size: 1.1rem;
    }

    .app-input-comic {
        padding: 10px;
        border: 3px solid #000;
        border-radius: 0; 
        outline: none;
        font-size: 1.1rem;
        box-shadow: 3px 3px 0 0 #000;
        font-family: 'Patrick Hand', cursive, sans-serif;
        height: 120px; 
        resize: vertical;
    }

    .char-counter {
        text-align: right;
        font-size: 0.9rem;
        color: #666;
        margin-top: 5px;
    }
    
    .app-button {
        width: 100%;
        padding: 12px;
        font-size: 1.5rem;
        font-weight: bold;
        text-align: center;
        border: 3px solid #000;
        border-radius: 8px; 
        cursor: pointer;
        margin-top: 20px;

        box-shadow: 4px 4px 0 0 #000;
        transition: transform 0.1s, box-shadow 0.1s, background-color 0.2s;

        display: inline-block;
    }

    .primary-button {
        background-color: #8B45B3; 
        color: white;
    }
    
    .secondary-button {
        background-color: #ccc;
        color: #000;
        border-color: #000;
    }

    .secondary-button:active {
        background-color: #bbb;
    }

    .app-button:active:not(.arrow-nav-button) {
        transform: translate(4px, 4px);
        box-shadow: 0 0 0 0 #000;
    }

    .app-button:disabled {
        background-color: #ccc;
        color: #999;
        border-color: #999;
        cursor: not-allowed;
        transform: none;
        box-shadow: 2px 2px 0 0 #999;
    }

    .disabled-hint {
        text-align: center;
        color: #999;
        font-size: 1rem;
        margin-top: 10px;
        margin-bottom: 0;
        font-style: italic;
    }
</style>